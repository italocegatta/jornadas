## ----message=FALSE, warning=FALSE----------------------------------------------------------------------------------------------------
library(tidyverse)
library(readxl)

tab_inv <- read_excel("input/TC5005_2017.xlsx")

ggplot(tab_inv, aes(x = dap, y = h))


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h)) +
  geom_point()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h)) +
  geom_point(shape = 2)


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h)) +
  geom_point(color = "red", size = 3)


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h)) +
  geom_smooth(method = "lm")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h)) +
  geom_smooth(method = "lm") +
  geom_point()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h)) +
  geom_point(alpha = 0.5) +
  labs(
    title = "Experimento TC5005",
    subtitle = "Fazenda Penha",
    caption = "Suzano SA",
    x = "CAP (cm)",
    y = "Altura (m)"
  ) +
  theme_bw()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h, color = cod1)) +
  geom_point() 


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h)) +
  geom_point(color = "red") 


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h, color = clone)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h)) +
  geom_point(aes(color = clone)) +
  geom_smooth(method = "lm")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv,  aes(x = dap, y = h, shape = clone)) +
  geom_point()


## ------------------------------------------------------------------------------------------------------------------------------------
tab_resumo_clone <- tab_inv %>% 
  group_by(clone) %>%
  summarise(
    h = mean(h, na.rm = TRUE),
    dap = mean(dap, na.rm = TRUE),
    n_arv = n(),
    n_falha = sum(if_else(cod1 == 1, 1, 0), na.rm = TRUE),
    p_falha = (n_falha / n_arv) * 100
  )

ggplot(tab_resumo_clone, aes(dap, clone)) +
  geom_col()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_resumo_clone, aes(clone, dap, color = clone)) +
  geom_col()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_resumo_clone, aes(clone, dap, fill = clone)) +
  geom_col()


## ------------------------------------------------------------------------------------------------------------------------------------
apropos("^geom_")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap)) +
  geom_histogram()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(h)) +
  geom_density(fill = "grey")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(h, fill = clone)) +
  geom_density()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(h, fill = clone, color = clone)) +
  geom_density(alpha = 0.3)


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(h, fill = clone, color = clone)) +
  geom_density(position = "stack")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(h, fill = clone, color = clone)) +
  geom_density(position = "fill")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(clone, h)) +
  geom_boxplot()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(clone, h)) +
  geom_boxplot() +
  geom_point()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(clone, h)) +
  geom_boxplot(outlier.color = NA) +
  geom_jitter(
    width = 0.1,
    alpha = 0.5
  )


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(clone, dap)) +
  geom_violin()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(clone, dap)) +
  geom_violin() +
  geom_jitter(alpha = 0.3, width = 0.1)


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_resumo_clone, aes(clone, dap)) +
  geom_col()


## ------------------------------------------------------------------------------------------------------------------------------------
tab_resumo_clone %>% 
  ggplot(aes(clone, dap, fill = n_falha)) +
    geom_col()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h, label = cod1)) +
    geom_point() +
    geom_label() +
    annotate("text", 15, 10, label = "Este é um comentário")


## ------------------------------------------------------------------------------------------------------------------------------------
apropos("^scale_x_")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h)) +
  geom_point()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h)) +
  geom_point() +
  scale_x_continuous(breaks = seq(0, 90, 2))


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h)) +
  geom_point() +
  scale_x_continuous(breaks = seq(0, 90, 5), labels = paste(seq(0, 90, 5), "cm"))


## ------------------------------------------------------------------------------------------------------------------------------------
apropos("^scale_color_")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h, color = clone)) +
  geom_point() +
  scale_fill_hue()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h, color = clone)) +
  geom_point() +
  scale_color_brewer(palette = "Set1")


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h, color = clone)) +
  geom_point() +
  scale_color_manual(values = c("red", "blue", "darkgreen", "gold", "cyan", "#fc9272", "#4a1486"))


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h, color = clone)) +
  geom_point() +
  scale_color_grey()


## ------------------------------------------------------------------------------------------------------------------------------------
ggplot(tab_inv, aes(dap, h, color = clone)) +
  geom_point() +
  geom_smooth(method = "lm") +
  facet_wrap(~clone) +
  scale_color_brewer(palette = "Dark2")

